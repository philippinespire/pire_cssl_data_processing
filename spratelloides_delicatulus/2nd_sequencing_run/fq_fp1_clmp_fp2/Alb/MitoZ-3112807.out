  You are loading a legacy samtools module, please load a up to date module
instead:
  
    module load container_env samtools
  
  Please run samtools command with "crun.samtools" prepend to it, for example:
  
    crun.samtools samtools
  
  Otherwise you will get "command not found" error. 
  You are loading a legacy bedtools module, please load a up to date module
instead:
  
    module load container_env bedtools
  
  Please run bedtools command with "crun.bedtools" prepend to it, for example:
  
    crun.bedtools bedtools
  
  Otherwise you will get "command not found" error. 
  You are loading a legacy samtools module, please load a up to date module
instead:
  
    module load container_env samtools
  
  Please run samtools command with "crun.samtools" prepend to it, for example:
  
    crun.samtools samtools
  
  Otherwise you will get "command not found" error. 
  You are loading a legacy bedtools module, please load a up to date module
instead:
  
    module load container_env bedtools
  
  Please run bedtools command with "crun.bedtools" prepend to it, for example:
  
    crun.bedtools bedtools
  
  Otherwise you will get "command not found" error. 
Sde-AGui_017-Ex1-cssl.
2024-04-11 20:37:23
/opt/MitoZ/bin/assemble/mitoAssemble all  -K 71 -o work71 -s work71.soaptrans.lib -p 20


mitoAssemble is based on SoapTrans v1.03 and modified to fit mitogenome assembly by BGI-ENVers

pregraph -s work71.soaptrans.lib -K 71 -p 20 -o work71 
In work71.soaptrans.lib, 1 libs, max seq len 150, max name len 256

20 thread created
read from file:
 /home/e1garcia/shotgun_PIRE/pire_cssl_data_processing/spratelloides_delicatulus/2nd_sequencing_run/fq_fp1_clmp_fp2/Alb/Sde-AGui_017-Ex1-cssl.clmp.fp2_r1.fq.gz
read from file:
 /home/e1garcia/shotgun_PIRE/pire_cssl_data_processing/spratelloides_delicatulus/2nd_sequencing_run/fq_fp1_clmp_fp2/Alb/Sde-AGui_017-Ex1-cssl.clmp.fp2_r1.fq.gz
time spent on hash reads: 12s, 2946896 reads processed
[LIB] 0, avg_ins 250, reverse 0 
23115120 nodes allocated, 86933558 kmer in reads, 86933558 kmer processed
21532461 linear nodes
time spent on marking linear nodes 0s
time spent on pre-graph construction: 12s

deLowKmer 0, deLowEdge 1
Start to remove kmer of out frequency kmers < 0.100000
67549 kmers off
20 thread created
0 linear nodes
time spent on cut kmer: 1s

Start to remove tips of single frequency kmers short than 142
0 tips off
20 thread created
0 linear nodes
Start to remove tips which don't contribute the most links
kmer set 0 done
kmer set 1 done
kmer set 2 done
kmer set 3 done
kmer set 4 done
kmer set 5 done
kmer set 6 done
kmer set 7 done
kmer set 8 done
kmer set 9 done
kmer set 10 done
kmer set 11 done
kmer set 12 done
kmer set 13 done
kmer set 14 done
kmer set 15 done
kmer set 16 done
kmer set 17 done
kmer set 18 done
kmer set 19 done
661447 tips off
20 thread created
0 linear nodes
time spent on cutTipe: 18s

536334 (268168) edges 35957 extra nodes
time spent on making edges: 7s

In file: work71.soaptrans.lib, max seq len 150, max name len 256

20 thread created
read from file:
 /home/e1garcia/shotgun_PIRE/pire_cssl_data_processing/spratelloides_delicatulus/2nd_sequencing_run/fq_fp1_clmp_fp2/Alb/Sde-AGui_017-Ex1-cssl.clmp.fp2_r1.fq.gz
read from file:
 /home/e1garcia/shotgun_PIRE/pire_cssl_data_processing/spratelloides_delicatulus/2nd_sequencing_run/fq_fp1_clmp_fp2/Alb/Sde-AGui_017-Ex1-cssl.clmp.fp2_r1.fq.gz
2946896 reads processed
time 1,1,1,1,0,0,0
searchKmer: kmer 0 444 4444444444444444 4444444444444444 is not found
searchKmer: kmer 0 1111 1111111111111111 1111111111111111 is not found
searchKmer: kmer 0 1111 1111111111111111 1111111111111111 is not found
0 markers outputed
done mapping reads, 1441198 reads deleted, 215938 arcs created
[LIB] 0, avg_ins 250, reverse 0 
time spent on mapping reads: 8s

302998 vertex outputed
overall time for lightgraph: 0m

contig -g work71 -M 3 
there're 302998 kmers in vertex file
there're 536334 edge in edge file
done sort
input 536334 edges
376784 pre-arcs loaded
start to pinch bubbles, cutoff 0.100000, MAX NODE NUM 30, MAX DIFF 10
156697 startingPoints, 111480 dheap nodes
885 pairs found, 599 pairs of paths compared, 260 pairs merged
sequenc compare failure: 0 339 0 0
DFibHeap: 355 Nodes allocated
a linear concatenation lap, 21708 concatenated
a linear concatenation lap, 85 concatenated
a linear concatenation lap, 0 concatenated
491688 edges in graph
time spent on bubblePinch: 0s

Start to remove the low coverage edge < 2
0 edges removed

strict 0, cutLen 142
a cutTipsInGraph lap, 210873 tips cut
a cutTipsInGraph lap, 22179 tips cut
a cutTipsInGraph lap, 5437 tips cut
a cutTipsInGraph lap, 1910 tips cut
a cutTipsInGraph lap, 869 tips cut
a cutTipsInGraph lap, 393 tips cut
a cutTipsInGraph lap, 242 tips cut
a cutTipsInGraph lap, 137 tips cut
a cutTipsInGraph lap, 88 tips cut
a cutTipsInGraph lap, 51 tips cut
a cutTipsInGraph lap, 16 tips cut
a cutTipsInGraph lap, 13 tips cut
a cutTipsInGraph lap, 7 tips cut
a cutTipsInGraph lap, 4 tips cut
a cutTipsInGraph lap, 1 tips cut
a cutTipsInGraph lap, 1 tips cut
a cutTipsInGraph lap, 4 tips cut
a cutTipsInGraph lap, 1 tips cut
a cutTipsInGraph lap, 3 tips cut
a cutTipsInGraph lap, 1 tips cut
a cutTipsInGraph lap, 1 tips cut
a cutTipsInGraph lap, 0 tips cut
2762 dead arcs removed
a linear concatenation lap, 2019 concatenated
a linear concatenation lap, 177 concatenated
a linear concatenation lap, 3 concatenated
a linear concatenation lap, 0 concatenated
2828 edges in graph
there're 536334 edges
after compacting 2830 edges left

delete unlike arc :1188
1 time to delete light arcs 
124 loops removed in Graph
Start to remove light arc using the rate 0.050000 and 0.020000
delete light arc :0/0

661 short contig(<48) removed 
a linear concatenation lap, 68 concatenated
a linear concatenation lap, 2 concatenated
a linear concatenation lap, 0 concatenated
1366 edges in graph
there're 2830 edges
after compacting 1368 edges left

673 ctgs longer than 100, sum up 167396bp, with average length 248
the longest is 2655bp, contig N50 is 229 bp,contig N90 is 195 bp
685 contigs longer than 72 output
time elapsed: 0m

map -s work71.soaptrans.lib -g work71 -p 20 -K 71 -f 
K = 71
contig len cutoff: 73

there're 685 contigs in file: work71, max seq len 2655, min seq len 72, max name len 10
time spent on parse contigs file 0s
20 thread created
time spent on hash reads: 0s
120181 nodes allocated, 120413 kmer in reads, 120413 kmer processed
time spent on De bruijn graph construction: 0s

In file: work71.soaptrans.lib, max seq len 150, max name len 256

20 thread created
1368 edges in graph
read from file:
 /home/e1garcia/shotgun_PIRE/pire_cssl_data_processing/spratelloides_delicatulus/2nd_sequencing_run/fq_fp1_clmp_fp2/Alb/Sde-AGui_017-Ex1-cssl.clmp.fp2_r1.fq.gz
read from file:
 /home/e1garcia/shotgun_PIRE/pire_cssl_data_processing/spratelloides_delicatulus/2nd_sequencing_run/fq_fp1_clmp_fp2/Alb/Sde-AGui_017-Ex1-cssl.clmp.fp2_r1.fq.gz
current insert size 250, map_len 32
Output 5124 out of 2946896 (0.2)% reads in gaps
117014 out of 2946896 (4.0)% reads mapped to contigs
1 pe insert size, the largest boundary is 2946896

[LIB] 0, avg_ins 250, reverse 0 
time spent on mapping reads: 8s

overall time for alignment: 0m

scaff -g work71 -F -p 20 
there're 1 grads, 2946896 reads, max read len 150
K = 71
there're 1368 edge in edge file
88 arcs loaded
input 685 contigs
done loading updated edges
time spent on loading edges 0s

for insert size: 250
Total_PE_link	Same_contig_right	Same_contig_wrong	Minus_dis_PE	Plus_dis_PE	Correct_PE	Accumulate_connect
58507	0	57224	160	0	1123	296
Using contigs longer than 250 to estimate insert size: 
Pair_num	SD	insert_size
0	148 new connections
all PEs attached
time spent on loading pair end info 0s


128 link to masked contigs, 0 links on a single scaff
Insert size 250: 147 links input
Cutoff for number of pairs to make a reliable connection: 3
all links loaded
time spent on creating scaffolds 0s

mask the short contigs, which are shorter than 100
160 links built by the informations of single read
54 weak connections(<10) removed (there were 66 active cnnects))
25 simple loops found and removed in graph
Begin to linearize the graph
Delete the unnecessary connections : 0+0
Remove the error connections
0 complex loops found and removed in graph
The second time to linearize the graph 
Delete the unnecessary connections : 0+0
Divided into 556 loci by the connections

There are 3 locis, which contain more than 2 contigs
The loci can be classified to four kinds:
LINEAR:1
FORK:2
BUBBLE:0
COMPLEX:0
time spent on creating transcriptome 0s

Start to load reads for gap filling. 50 length discrepancy is allowed
...
Loaded 5124 reads from work71.readInGap
20 thread created
...
Done with 5 scaffolds, 0 gaps finished, 0 gaps overall
Threads processed 5 scaffolds
time elapsed: 0m
time for the whole pipeline: 0m
2024-04-11 20:38:20
rm -rf work71*.Arc work71*.ContigIndex work71*.PEreadOnContig.gz work71*.agp work71*.contig work71*.ctg2Read work71*.edge.gz work71*.gapSeq work71*.kmerFreq work71*.newContigIndex work71*.peGrads work71*.preArc work71*.preGraphBasic work71*.readInGap work71*.readInformation work71*.readOnContig work71*.readOnScaf work71*.scaf_gap work71*.shortreadInGap.gz work71*.updated.edge work71*.vertex

2024-04-11 20:38:20
nhmmer -o work71.hmmout --tblout work71.hmmtblout --cpu 20 /opt/MitoZ/bin/profiles/CDS_HMM/Chordata_CDS.hmm /home/e1garcia/shotgun_PIRE/pire_cssl_data_processing/spratelloides_delicatulus/2nd_sequencing_run/fq_fp1_clmp_fp2/Alb/Sde-AGui_017-Ex1-cssl._MitoZ/tmp/Sde-AGui_017-Ex1-cssl..assembly/work71.scafSeq

2024-04-11 20:38:21
/opt/conda/bin/python3 /opt/MitoZ/bin/findmitoscaf/get_besthit_of_each_CDS_from_nhmmer.py work71.hmmtblout work71.hmmtblout.besthit

2024-04-11 20:38:21
/opt/conda/bin/python3 /opt/MitoZ/bin/findmitoscaf/simlify_nhmmer_tbl_besthit.py work71.hmmtblout.besthit work71.hmmtblout.besthit.sim

2024-04-11 20:38:21
/opt/conda/bin/python3 /opt/MitoZ/bin/findmitoscaf/extract_fasta.py -i /home/e1garcia/shotgun_PIRE/pire_cssl_data_processing/spratelloides_delicatulus/2nd_sequencing_run/fq_fp1_clmp_fp2/Alb/Sde-AGui_017-Ex1-cssl._MitoZ/tmp/Sde-AGui_017-Ex1-cssl..assembly/work71.scafSeq -q work71.hmmtblout.besthit.sim -o work71.hmmtblout.besthit.sim.fa

CDS_found_lengths_list:  [0]
quick mode got no result!
